#!/bin/bash

case "$(uname)" in
Darwin) this_computer=$(scutil --get ComputerName) ;;
Linux) this_computer=$(hostname) ;;
esac

computers=("turnip" "sfizio" "cipolla" "xicamatl")

timeout=30
for computer in "${computers[@]}"; do
    if [ "$this_computer" != "$computer" ]; then
        echo "ðŸ”„  running 'dotfiles pull' on $computer.."
        if ! ssh -o ConnectTimeout=${timeout} "$computer" "source ~/.config/shell/includes/dotfiles.sh && dotfiles pull" 2>/dev/null; then
            echo "Waited $timeout seconds.. $computer must be asleep."
        fi
    fi
done
