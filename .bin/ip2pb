#!/bin/bash

if command -v curl &>/dev/null; then
    ip=$(curl -s portquiz.net | grep -oE '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}')
elif command -v wget &>/dev/null; then
    ip=$(wget -qO- portquiz.net:80 | grep -oE '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}')
else
    echo "Script requires curl or wget; neither found, exiting."
    exit 1
fi

printf "Your IP address is %s" "$ip"

if command -v pbcopy >/dev/null 2>&1; then
    printf '%s' "$ip" | pbcopy
    echo " (copied to paste buffer)"
elif command -v xclip >/dev/null 2>&1; then
    printf '%s' "$ip" | xclip -selection clipboard
    echo " (copied to paste buffer)"
elif command -v xsel >/dev/null 2>&1; then
    printf '%s' "$ip" | xsel --clipboard --input
    echo " (copied to paste buffer)"
elif command -v wl-copy >/dev/null 2>&1; then
    printf '%s' "$ip" | wl-copy
    echo " (copied to paste buffer)"
elif command -v clip >/dev/null 2>&1; then
    printf '%s' "$ip" | clip
    echo " (copied to paste buffer)"
else
    echo
fi
